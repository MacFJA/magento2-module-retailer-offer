<?php
/**
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this module to newer
 * versions in the future.
 *
 *
 * @category  Smile
 * @package   Smile\RetailerOffer
 * @author    Romain Ruaud <romain.ruaud@smile.fr>
 * @copyright 2017 Smile
 * @license   Open Software License ("OSL") v. 3.0
 */

/**
 * Template to display store availability on product view.
 *
 * @var $block \Smile\RetailerOffer\Block\Catalog\Product\Retailer\Availability
 */
?>
<div id="catalog-product-retailer-availability" data-block="catalog-product-retailer-availability" class="block catalog-product-retailer-availability">
    <div class="block catalog-product-stores-availability-content"
         data-role="dropdownDialog"
         data-bind="scope: 'catalog-product-retailer-availability'"
         data-mage-init='{
           "Magento_Ui/js/modal/modal":{
             "trigger":".showavailability",
             "buttons":[],
             "modal":true
           }
         }'>
        <div class="store-offers-list" data-role="content">
            <ul data-bind="foreach: storeOffers">
                <li data-bind="template: $parent.storeOffersListTemplate" class="result-item"></li>
            </ul>
        </div>
    </div>
    <div class="catalog-product-retailer-availability-content">
        <div class="title">
            <span><?php echo __("Store availability : ") ;?></span>
        </div>
        <div class="content-wrapper" data-bind="scope: 'catalog-product-retailer-availability'">
            <div data-bind="visible: hasStore()" class="current-store">
                <p class="availability" data-bind="css: { inStock: getIsInStock() == true, outOfStock: getIsInStock() == false }">
                    <span data-bind="text: getStoreName() + ':' " class="store-name-value"></span>
                    <span data-bind="html: getStockLabel()" class="stock-label"></span>
                </p>
            </div>
        </div>
    </div>
    <div class="action showavailability" data-bind="scope: 'catalog-product-retailer-availability'">
        <a href="#" class="text" data-bind="text: getLinkLabel()"></a>
    </div>
</div>

<script type="text/x-magento-init">
    { "*" : { "Magento_Ui/js/core/app": <?php echo  /* @noEscape */ $block->getJsLayout(); ?> } }
</script>
